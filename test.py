import rsa
from datetime import datetime
import string
import random
import json


'''
blockchain = [
[
1617780301.862646,
0,
[[[119770777999616036964482036516193989899837494454402262212320174845526315404803216372320908306890372744930417223903886098713646467509959684974498601907444633130871922367704281375480264549968160821209935332888725265017711576900685345115234860380091711666493101127543579986394987372953112289819973821762408459967, 65537],
'root1@test.it',
'kfoqwttvmxhqrcfdxqlg',
'650b7c1fe18c15ce3ec10cd3a88f862f42ab1b116268edd444275750443f13a62693d41bdc3f6313374c4b4130bc42b5ecc5ff8a58587d773dea1aa2700688f37f17ae2a37b51a28543a47fd16d407675da7aecd51e4c239bb2da3aeea09518d6c2e8b6f2afb12dc65db5258361871ae58cb0cf99ab4967a7628e3edcb214f95'
],
[[116004225281319987658573288348459366496825961115624594341053052723162029806559546870943101465716069245005380880466778730925720191554438789145759559892723660608772015906113267763487059561271967567199756257816686273390854357775870689254778084091408084059783060034916665868756548222191625642387394930123129730919, 65537],
'root2@test.it',
'cgdadgrwscajpgwychvy',
'6d13bbc4dcc152939c8572c7a5109c8084f82826c6db0d82af7db31f91fb5d5ab3d01997375afa72ef6fe818a403eedebe2b5af4aa07e62455ff482bf9134ed2101d5a8949db49251646df80fe2a15777ab0217b949ee10b12367ed4db2933479a480b154ed7a1e2a28c7d1dcfc284d6bc78704d642904cefe4b51635715c723'
],
[[109408188808701462640681109534230415304054106571571409068865576027621529910922398951526070278451372101046352348576215241867114264747162101621938943056178439695690196413133683262343747311106890948975255893206864300355425778544110774780433868823662949090038382720445032632463499921195438372329573837611870173277, 65537],
'root3@test.it',
'ujshhrglokuacrmrjthv',
'1170d3ebee7fc8e50a9091d3bd93a9356a91bbcfa3147fc774cb8bcbe383505cf1218ac3f894afbdb8a364f6bab854e838620b9f409cbce1eab06b3431b1dfae4f5dcae3816961a4b7b6f04074248b6fa328edaeeab2302ddac3c9beedca9d16cf24f8b60b8951b4f59821771cb253d30f3a42f07c67e434ddd2ac3d0b520444'
]],
'ede4e1515c13920d57a032345b02073a0a8df2d74b506754c5a1543ab8d1b656',
['root1@test.it', 'root2@test.it', 'root3@test.it'],
['signature1','signature2','signature3']
]
]

with open('blockchain.json', 'w') as outfile:
    json.dump(blockchain, outfile,indent=1)

with open('blockchain.json', 'r') as outfile:
    blockchain1=json.load(outfile)
#print(blockchain)
block = blockchain1[0]
hash = rsa.compute_hash(str.encode(str([block[0],block[1],block[2],block[4]])), 'SHA-256').hex()
print(hash)
'''

'''
pubkey = rsa.PublicKey(109408188808701462640681109534230415304054106571571409068865576027621529910922398951526070278451372101046352348576215241867114264747162101621938943056178439695690196413133683262343747311106890948975255893206864300355425778544110774780433868823662949090038382720445032632463499921195438372329573837611870173277, 65537)
privkey = rsa.PrivateKey(109408188808701462640681109534230415304054106571571409068865576027621529910922398951526070278451372101046352348576215241867114264747162101621938943056178439695690196413133683262343747311106890948975255893206864300355425778544110774780433868823662949090038382720445032632463499921195438372329573837611870173277, 65537, 45506474491300992876120761780270486759741991409958726212798979766192155329689086668899234779137066879814799558567512264492663193962843763494093910425610983554005997286234475141975340643742712015777804207496155334910020640773306453461045307844102122538866056278052833734250234103417673578143880763270663772853, 38196746067665208846318603661019859626469465948352325521601923806482253200289334112047295440512532950051393369177934693725502119802374393783504063188907822979385147, 2864332700353213131452119459146118535261726744960550663702850991242233277360099402842124943729519059624954124555522674428143485009472784984126791)
strpubkey = str(pubkey.n) + ' ' + str(pubkey.e)

verify = 'pk ' + strpubkey + ' ' + 'email ' + 'root3@test.it' + ' ' + 'sign ' + 'ujshhrglokuacrmrjthv'
signature = rsa.sign(verify.encode('utf-8'), privkey,'SHA-256').hex()
print(signature)
'''
'''
hash = rsa.compute_hash(str(a).encode(), 'SHA-256')
print(str(a).encode())
print(hash.hex())

(pubkey1, privkey1) = rsa.newkeys(1024)
(pubkey2, privkey2) = rsa.newkeys(1024)
(pubkey3, privkey3) = rsa.newkeys(1024)

print((pubkey1, privkey1))
print((pubkey2, privkey2))
print((pubkey3, privkey3))
'''
'''
now = datetime.now()
block = datetime.timestamp(now)
print(block)
letters = string.ascii_lowercase
challange = ''.join(random.choice(letters) for i in range(20))
print(challange)
'''
'''
Root 1
PublicKey(119770777999616036964482036516193989899837494454402262212320174845526315404803216372320908306890372744930417223903886098713646467509959684974498601907444633130871922367704281375480264549968160821209935332888725265017711576900685345115234860380091711666493101127543579986394987372953112289819973821762408459967, 65537), PrivateKey(119770777999616036964482036516193989899837494454402262212320174845526315404803216372320908306890372744930417223903886098713646467509959684974498601907444633130871922367704281375480264549968160821209935332888725265017711576900685345115234860380091711666493101127543579986394987372953112289819973821762408459967, 65537, 26672787965643774653960592077053439775823248417870836580692020566557159670615117307078805205289607248001273164515879848188438137133342411190667965317897481933437357035191631621435183169027975469714776027703265905819830236529825367804990665646494281767030763234952167320037607890847457162373522698431596532433, 44659137180340759958876268803910738747846956308877335366447217803000626835077167992126311203807815386442987763059259322597082273294981350200211351269897238930582823, 2681887415691942777453365642395488321778607617182533102316008461281165410069044712411935606017878562867819962411244465549964698676032292471234729)
'''
'''
Root 2
PublicKey(116004225281319987658573288348459366496825961115624594341053052723162029806559546870943101465716069245005380880466778730925720191554438789145759559892723660608772015906113267763487059561271967567199756257816686273390854357775870689254778084091408084059783060034916665868756548222191625642387394930123129730919, 65537), PrivateKey(116004225281319987658573288348459366496825961115624594341053052723162029806559546870943101465716069245005380880466778730925720191554438789145759559892723660608772015906113267763487059561271967567199756257816686273390854357775870689254778084091408084059783060034916665868756548222191625642387394930123129730919, 65537, 113320818876899872284198551861646354006031628798745779549087652599135699074503696388675836534119786824762950537076211012597395858576174156886959581017346963896001018404143622564211141719854525829550608916151368531836600479017473926312966740769334280199642829633488405627689309329200361626967289394328986603433, 42529141898798550074390381613514100832398610399548991394201753219908682699756557812504021128503749882433121509892134810553736929811847405998308431364025901191831659, 2727640862290642914891780043841902802059534011350400735385751755117353221263229955061265447186961196541215691807749681300629491007786242856113141)
'''
'''
Root3
PublicKey(109408188808701462640681109534230415304054106571571409068865576027621529910922398951526070278451372101046352348576215241867114264747162101621938943056178439695690196413133683262343747311106890948975255893206864300355425778544110774780433868823662949090038382720445032632463499921195438372329573837611870173277, 65537), PrivateKey(109408188808701462640681109534230415304054106571571409068865576027621529910922398951526070278451372101046352348576215241867114264747162101621938943056178439695690196413133683262343747311106890948975255893206864300355425778544110774780433868823662949090038382720445032632463499921195438372329573837611870173277, 65537, 45506474491300992876120761780270486759741991409958726212798979766192155329689086668899234779137066879814799558567512264492663193962843763494093910425610983554005997286234475141975340643742712015777804207496155334910020640773306453461045307844102122538866056278052833734250234103417673578143880763270663772853, 38196746067665208846318603661019859626469465948352325521601923806482253200289334112047295440512532950051393369177934693725502119802374393783504063188907822979385147, 2864332700353213131452119459146118535261726744960550663702850991242233277360099402842124943729519059624954124555522674428143485009472784984126791)
'''
